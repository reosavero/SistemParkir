<div class="container mt-4">
  <h2 class="mb-4">Daftar Kendaraan</h2>

  <!-- Form Tambah Kendaraan -->
  <form action="/kendaraan/add" method="POST" enctype="multipart/form-data" class="row g-2 mb-4">
    <div class="col-md-3">
      <input name="nopolisi" class="form-control" placeholder="No. Polisi" required>
    </div>
    <div class="col-md-2">
      <select name="type" class="form-select">
        <option value="motor">Motor</option>
        <option value="mobil">Mobil</option>
      </select>
    </div>
    <div class="col-md-3">
      <select name="id_tarif" class="form-select" required>
        <% tariffs.forEach(t => { %>
          <option value="<%= t.id_tarif %>">
            <%= t.type %> - Rp <%= t.harga %> / <%= t.waktu %> menit
          </option>
        <% }) %>
      </select>
    </div>
    <div class="col-md-2">
      <input name="warna" class="form-control" placeholder="Warna">
    </div>
    <div class="col-md-2">
      <input type="file" name="foto" class="form-control">
    </div>
    <div class="col-md-12 d-flex justify-content-end">
      <button class="btn btn-success">+ Tambah Kendaraan</button>
    </div>
  </form>

  <!-- Tabel Kendaraan -->
  <% if (kendaraan.length > 0) { %>
    <table class="table table-bordered table-hover table-striped">
      <thead class="table-dark text-center">
        <tr>
          <th>#</th>
          <th>No. Polisi</th>
          <th>Jenis</th>
          <th>Tarif</th>
          <th>Jam Masuk</th>
          <th>Jam Keluar</th>
          <th>Status</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody>
        <% kendaraan.forEach((k,i) => { %>
          <tr>
            <td class="text-center"><%= i+1 %></td>
            <td><%= k.nopolisi %></td>
            <td><span class="badge bg-info text-dark"><%= k.type %></span></td>
            <td class="text-center">Rp <%= k.harga || '-' %></td>
            <td class="text-center"><%= k.jam_masuk %></td>
            <td class="text-center"><%= k.jam_keluar || '-' %></td>
            <td class="text-center">
              <% if (k.status === 'sudah bayar') { %>
                <span class="badge bg-success">Selesai</span>
              <% } else { %>
                <span class="badge bg-warning text-dark"><%= k.status %></span>
              <% } %>
            </td>
            <td class="text-center">
              <% if (!k.jam_keluar) { %>
                <form action="/kendaraan/exit/<%= k.id_kendaraan %>" method="post" style="display:inline">
                  <button class="btn btn-sm btn-warning">Keluar</button>
                </form>
              <% } else if (k.status !== 'sudah bayar') { %>
                <a class="btn btn-sm btn-success" href="/kendaraan/bayar/<%= k.id_kendaraan %>">Bayar</a>
              <% } else { %>
                <a href="/kendaraan/delete/<%= k.id_kendaraan %>" 
                   class="btn btn-sm btn-danger" 
                   onclick="return confirm('Yakin ingin menghapus data kendaraan ini?')">
                   Hapus
                </a>
              <% } %>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } else { %>
    <p class="text-center text-muted">Belum ada kendaraan yang terdaftar</p>
  <% } %>

  <div class="d-flex justify-content-start mt-3">
    <a href="/dashboard" class="btn btn-secondary">Kembali</a>
  </div>
</div>
